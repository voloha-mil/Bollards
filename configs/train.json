{
  "data": {
    "train_csv": "local_data/meta/train.csv",
    "val_csv": "local_data/meta/val.csv",
    "img_root": "local_data",
    "country_map_json": "local_data/meta/country_map.json",
    "golden_csv": "golden_dataset/labels.csv",
    "golden_img_root": "golden_dataset",
    "img_size": 224,
    "batch_size": 128,
    "num_workers": 4,
    "val_num_workers": 0,
    "golden_num_workers": 0,
    "prefetch_factor": 1,
    "persistent_workers": false,
    "balanced_sampler": true,
    "sampler_alpha": 0.5,
    "expand": 2.0,
    "max_train_samples": 100000,
    "max_val_samples": 2000
  },
  "augment": {
    "enabled": true,
    "resize_pad": 32,
    "crop_scale_min": 0.9,
    "crop_scale_max": 1.0,
    "hflip_p": 0.5,
    "brightness": 0.15,
    "contrast": 0.15,
    "saturation": 0.1,
    "hue": 0.02,
    "blur_p": 0.15,
    "blur_kernel": 3,
    "affine_p": 0.5,
    "affine_degrees": 7.0,
    "affine_translate": 0.02,
    "affine_scale_min": 0.95,
    "affine_scale_max": 1.05
  },
  "model": {
    "backbone_name": "efficientnet_b1",
    "pretrained": true,
    "num_classes": 128,
    "img_emb_dropout": 0.2,
    "meta_dim": 5,
    "meta_hidden": 64,
    "meta_dropout": 0.0,
    "head_hidden": 256,
    "head_layers": 2,
    "head_dropout": 0.2
  },
  "optim": {
    "lr": 0.0003,
    "backbone_lr": 0.0001,
    "weight_decay": 0.0001,
    "label_smoothing": 0.05,
    "conf_weight_min": 0.2,
    "class_weighting": false,
    "focal_gamma": 0.0,
    "focal_alpha": null
  },
  "schedule": {
    "epochs": 80,
    "freeze_epochs": 1,
    "lr_scheduler": "reduce_on_plateau",
    "cosine": {
      "t_max": null,
      "eta_min": 0.0
    },
    "reduce_on_plateau": {
      "monitor": "val_map",
      "mode": "max",
      "factor": 0.5,
      "patience": 2,
      "threshold": 0.0001,
      "threshold_mode": "rel",
      "cooldown": 0,
      "min_lr": 0.0,
      "eps": 1e-8
    }
  },
  "logging": {
    "out_dir": "runs/bollard_country",
    "tb_dir": null,
    "run_name": "30_12_plateu",
    "log_images": 4,
    "log_image_every": 1,
    "tb_font_size": 18,
    "best_metric": "val_map"
  },
  "hub": {
    "enabled": false,
    "repo_id": "olehborovyk/bollards",
    "private": false,
    "token_env": "HF_TOKEN",
    "path_in_repo": null,
    "upload_include": [
      "best.pt",
      "config.json",
      "country_map.json",
      "country_list.json",
      "country_counts.csv",
      "country_mapping.json"
    ],
    "commit_message": "Add best checkpoint",
    "fail_on_error": false
  },
  "analyze": {
    "enabled": false,
    "config_path": "configs/analyze_run.json"
  },
  "device": "cuda",
  "seed": 42
}
